{"version":3,"sources":["webpack:///src/app/@pages/ofertas/sector/sector.component.html","webpack:///src/app/@pages/ofertas/sector/sector.module.ts","webpack:///src/app/@pages/ofertas/sector/sector.component.ts"],"names":["SectorComponent","SectorModule","app","path","component","router","db","seo","util","act","storageMap","isLoading","p","search","viewDepart","viewSector","init","url","menu","proccess","slug","this","addCanonical","getSector","nome","split","link","toSlug","menuSector$","getMenuOfertas","pipe","map","res","tap","dep_id","codigo","watchStorage","finalize","depId","watch","subscribe","loja","getMenuDepartamento","sector$","getCollection","items$","OfertasLojaDepartamentoSetor","data","filter","row","produtos","toogle","busca","e","target","value","Seo","title","setTitle","updateTagName","dataLayerPage","trackBy","index","item","slug$","paramMap","paramsMap","get","subscription","unsubscribe","forChild"],"mappings":"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","file":"x","sourcesContent":["<section id=\"sector\" class=\"py-5\" *ngIf=\"(menuSector$ | async) as path\">\n  <div class=\"container\">\n    <mdb-breadcrumb class=\"mb-5\">\n      <mdb-breadcrumb-item class=\"blue-text text-uppercase\" [routerLink]=\"['/departamento', url.link]\">\n        {{url.nome}}</mdb-breadcrumb-item>\n      <mdb-breadcrumb-item class=\"text-muted text-uppercase\"> {{ path['nome'] }} </mdb-breadcrumb-item>\n    </mdb-breadcrumb>\n    <div class=\"row ios justify-content-center\">\n      <div class=\"col-lg-4 col-xl-3 bg-red\">\n        <app-select-loja type=\"alert\"></app-select-loja>\n        <h5 class=\"border-bottom pb-1 b-06 my-4 text-capitalize\">{{url.nome}}</h5>\n        <div class=\"news my-4\">\n          <h5 class=\"b-07 border-bottom pb-1 mb-1\" (click)=\"toogle()\">\n            Setor <i class=\"fas float-right\" [ngClass]=\"{'fa-plus': !viewSector, 'fa-minus': viewSector}\"></i>\n          </h5>\n          <ul class=\"nav flex-column grey lighten-4 py-2 animated fadeIn faster\" data-wow-delay=\".1\" *ngIf=\"viewSector\">\n            <li class=\"nav-item\" *ngFor=\"let n of sector$ | async\" routerLinkActive=\"active\">\n              <a class=\"nav-link b-07 f-09\" [routerLink]=\"['/departamento', url.link, 'setor', n.slug]\">\n                {{ n.sector }}\n              </a>\n            </li>\n          </ul>\n        </div>\n      </div>\n        <div class=\"col-lg-8 col-xl-9\">\n          <h1 class=\"b-08 border-bottom pb-1 mb-3 text-capitalize\">{{ path['nome']  }}</h1>\n          <img src=\"./assets/images/banner_campanha.jpg\" onerror=\"this.style.display='none'\" class=\"img-fluid mb-4\"/>\n          <input type=\"text\" class=\"form-control\" placeholder=\"Procure produtos deste setor\" (change)=\"busca($event)\">\n          <div class=\"row mt-3\">\n            <div class=\"col-6 col-md-4 col-lg-4 col-xl-4 mb-3\"\n              *ngFor=\"let item of items$ | async | filtro: search:'dsc_produto'  | paginate: { itemsPerPage: 6, currentPage: p }; let i = index; trackBy: trackBy\">\n              <app-product [code]=\"item\"></app-product>\n            </div>\n          </div>\n          <div class=\"mt-5\">\n            <pagination-controls class=\"animated fade text-center mt-5 border-top pt-1\"\n                (pageChange)=\"p = $event\" previousLabel=\"Anterior\" nextLabel=\"PrÃ³ximo\" responsive=\"true\">\n            </pagination-controls>\n          </div>\n        </div>\n    </div>\n  </div>\n</section>\n<app-sem-data *ngIf=\"isLoading\"></app-sem-data>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { NgxPaginationModule } from 'ngx-pagination';\nimport { MDBBootstrapModule } from 'angular-bootstrap-md';\n\nimport { PipesModule } from '@core/pipes/pipes.module';\nimport { SemDataModule } from '@sharing/sem-data/sem-data.module';\nimport { ProductModule } from '@sharing/product/product.module';\nimport { SelectLojaModule } from '@sharing/select-loja/select-loja.module';\n\nimport { SectorComponent } from './sector.component';\n\nconst app: Routes = [\n  { path: ':slug', component: SectorComponent },\n];\n\n@NgModule({\n  declarations: [SectorComponent],\n  imports: [\n    PipesModule,\n    CommonModule,\n    SemDataModule,\n    ProductModule,\n    SelectLojaModule,\n    MDBBootstrapModule,\n    NgxPaginationModule,\n    RouterModule.forChild(app)\n  ]\n})\nexport class SectorModule { }\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\n\nimport { StorageMap } from '@ngx-pwa/local-storage';\nimport { Subscription, Observable } from 'rxjs';\nimport { map, tap, finalize } from 'rxjs/operators';\n\nimport { SeoService } from '@core/services/seo.service';\nimport { UtilService } from '@core/services/util.service';\nimport { DataService } from '@core/services/data.service';\nimport { MenuSetor } from '@core/interfaces/menu';\nimport { Ofertas } from '@core/interfaces/ofertas';\n\n@Component({\n  selector: 'app-sector',\n  templateUrl: './sector.component.html',\n  styleUrls: ['./sector.component.scss']\n})\nexport class SectorComponent implements OnInit, OnDestroy {\n\n  subscription: Subscription;\n  isLoading: boolean = false;\n  p: number = 1;\n  search: string = '';\n\n  viewDepart: boolean = true;\n  viewSector: boolean = true;\n  init: boolean = false;\n\n  url: any = [];\n  menu: any = [];\n  sector$: Observable<MenuSetor[]>;\n\n  slug$: Observable<string>;\n  items$: Observable<Ofertas[]>;\n  menuSector$: Observable<MenuSetor>;\n\n  constructor(\n    private router: Router,\n    private db: DataService,\n    private seo: SeoService,\n    private util: UtilService,\n    private act: ActivatedRoute,\n    private storageMap: StorageMap,\n  ) { }\n\n  ngOnInit(): void {\n    this.slug$ = this.act.paramMap.pipe(map(paramsMap => paramsMap.get('slug')));\n    this.slug$.subscribe(data => this.proccess(data));\n  }\n\n  ngOnDestroy(): void {\n    if (this.subscription) { this.subscription.unsubscribe(); }\n  }\n\n  private proccess = (slug: any) => {\n    this.seo.addCanonical();\n    this.getSector(slug)\n  }\n\n  getSector = (slug: string) => {\n    this.isLoading = true;\n    this.url = { nome: this.router.url.split('/')[2], link: this.util.toSlug(this.router.url.split('/')[2]) };\n    this.menuSector$ = this.db.getMenuOfertas(`menuSetorSlug?slug=${slug}`).pipe(\n      map((res) => res[0]), tap(({ dep_id, codigo }) => this.watchStorage(dep_id, codigo),\n      finalize(() => this.isLoading = false))\n    );\n  }\n\n  private watchStorage = (depId: number, codigo: number) => {\n    this.storageMap.watch('Loja').subscribe(({ loja }) => {\n      this.getMenuDepartamento(loja);\n      this.sector$ = this.db.getCollection(`/Menus/MenuSectorOfertasLojaDepartamento?loja=${loja}&departamento=${depId}`);\n      this.items$ = this.db.OfertasLojaDepartamentoSetor(loja, depId, codigo).pipe(\n        map((data) => data.filter((row) => row.produtos))\n      );\n    })\n  }\n\n\n  getMenuDepartamento = (loja: number) => this.menu = this.db.getCollection(`/Menus/MenuDepartamentoOfertasLojaDepartamento?loja=${loja}`);\n\n  toogle = () => this.viewSector = !this.viewSector;\n  busca = (e: any) => this.search = e.target.value;\n\n  private Seo = (title: string) => {\n    this.seo.addCanonical();\n    this.seo.setTitle(`${title} | Rede Condor`);\n    this.seo.updateTagName(`${title} | Rede Condor`);\n    this.seo.dataLayerPage(title);\n  }\n  trackBy = (index: number, item: any) => item[index];\n\n}\n"]}