{"version":3,"sources":["webpack:///src/app/@pages/ofertas/search/search.component.html","webpack:///src/app/@pages/ofertas/search/search.module.ts","webpack:///src/app/@pages/ofertas/search/search.component.ts"],"names":["SearchComponent","SearchModule","app","path","component","seo","util","db","act","storageMap","loja","items","fill","product","message","trackBy","index","item","this","addCanonical","slug","paramMap","pipe","map","paramsMap","get","subscribe","data","Search","err","console","log","ofertas","fills","text","split","join","search","watch","res","k","i","campanhaId","campanha","hostId","host","departamento","preco_regular","parcela_regular","qtd_regular","preco_clube","parcela_clube","qtd_clube","dsc_kit","cod_kit","produtos","push","length","dataLayerTracking","event","searchTerm","forChild"],"mappings":"qmBAIY,gBACI,wBACJ,Q,uBADiB,wBCM7B,ICMaA,EDOAC,EAbPC,EAAc,CAAE,CAAEC,KAAM,QAASC,WCM1BJ,EAAN,WASL,WACUK,EACAC,EACAC,EACAC,EACAC,aAJA,KAAAJ,MACA,KAAAC,OACA,KAAAC,KACA,KAAAC,MACA,KAAAC,aAXV,KAAAC,KAAY,GACZ,KAAAC,MAAa,GACb,KAAAC,KAAY,GACZ,KAAAC,QAAe,GACf,KAAAC,QAAkB,GA0ElB,KAAAC,QAAU,SAACC,EAAeC,GAAhB,OAA8BA,EAAKD,I,UAjFxC,O,EAAA,G,EAAA,uBAiBL,WAAU,WACRE,KAAKb,IAAIc,eACTD,KAAKE,KAAOF,KAAKV,IAAIa,SAASC,KAAK,OAAAC,EAAA,IAAIC,YAASA,OAAIA,EAAUC,IAAI,YAClEP,KAAKE,KAAKM,WAAUC,YAClBT,EAAKU,OAAOD,MACXE,YAAGA,OAAIC,QAAQC,IAAIF,QAtBnB,oBAyBL,SAAOT,cACDY,EAAe,GACbC,EAAa,GACbC,EAAOd,EAAKe,MAAM,KAAKC,KAAK,OAC5BC,EAASjB,EAAKe,MAAM,KAAKC,KAAK,KACpClB,KAAKT,WAAW6B,MAAM,QAAQZ,WAAU,YAAGhB,aACzCQ,EAAKX,GAAGqB,OAAOM,GAAMR,WACnBa,YAEE,IAAK,IAAMC,KAAKD,EAEd,IAAK,IAAME,KAAKF,EAAIC,GAAGR,QACjBO,EAAIC,GAAGR,QAAQS,GAAG/B,QAAUA,IAC9BsB,EAAU,CACRU,WAAYH,EAAIC,GAAGR,QAAQS,GAAGC,WAC9BC,SAAUJ,EAAIC,GAAGR,QAAQS,GAAGE,SAC5BC,OAAQL,EAAIC,GAAGR,QAAQS,GAAGG,OAC1BC,KAAMN,EAAIC,GAAGR,QAAQS,GAAGI,KACxBnC,KAAM6B,EAAIC,GAAGR,QAAQS,GAAG/B,KACxBoC,aAAcP,EAAIC,GAAGR,QAAQS,GAAGK,aAChC1B,KAAMmB,EAAIC,GAAGR,QAAQS,GAAGrB,KACxB2B,cAAeR,EAAIC,GAAGR,QAAQS,GAAGM,cACjCC,gBAAiBT,EAAIC,GAAGR,QAAQS,GAAGO,gBACnCC,YAAaV,EAAIC,GAAGR,QAAQS,GAAGQ,YAC/BC,YAAaX,EAAIC,GAAGR,QAAQS,GAAGS,YAC/BC,cAAeZ,EAAIC,GAAGR,QAAQS,GAAGU,cACjCC,UAAWb,EAAIC,GAAGR,QAAQS,GAAGW,UAC7BC,QAASd,EAAIC,GAAGR,QAAQS,GAAGY,QAC3BC,QAASf,EAAIC,GAAGR,QAAQS,GAAGa,QAC3BC,SAAUhB,EAAIC,IAEhBP,EAAMuB,KAAKxB,IAIjBd,EAAKP,MAAQsB,EACTf,EAAKP,MAAM8C,OAAS,GACtBvC,EAAKJ,QAALI,gDAAwDmB,EAAxDnB,MACAA,EAAKb,IAAIqD,kBAAkB,CACzBC,MAAO,aACPC,WAAYvB,MAGdnB,EAAKb,IAAIqD,kBAAkB,CACzBC,MAAO,WACPC,WAAYvB,IAEdnB,EAAKJ,QAAU,yHAGnBe,YACEC,QAAQC,IAAIF,c,2BA5Ef,K,sCAAM7B,GAAe,oD,uBAAfA,EAAe,+YFjB5B,oBACI,gBACI,eACA,gBACI,sBAGJ,OACA,+BAGJ,OACJ,Q,MAV2C,yCAEK,gCAA4C,0BAIhE,6BAAgB,4B,mpOCgBrC,IAAMC,EAAN,yB,qBAAMA,I,oDAAAA,IAAY,SATd,CACP,IACA,IACA,IACA,IACA,IACA,IAAa4D,SAAS3D,O","file":"x","sourcesContent":["<section id=\"search\" class=\"p-y-3 py-md-5\">\n    <div class=\"container\">\n        <h1 class=\"h2-responsive b-7 mb-4\" [innerHTML]=\"message\"></h1>\n        <div class=\"row mb-4\">\n            <div class=\"col-md-4 mb-4 col-lg-3\" *ngFor=\"let item of items; trackBy: trackBy\">\n                <app-product [code]=\"item\"></app-product>\n            </div>\n        </div>\n        <app-widget-ofertas [code]=\"'geral'\" [sector]=\"product.setor\" title=\"Mais ofertas\"\n            icon=\"fas fa-shopping-basket\" type=\"slug\">\n        </app-widget-ofertas>\n    </div>\n</section>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Routes, RouterModule } from '@angular/router';\nimport { MDBBootstrapModule } from 'angular-bootstrap-md';\n\nimport { PipesModule } from '@core/pipes/pipes.module';\nimport { OfertasModule } from '@widgets/ofertas/ofertas.module';\nimport { ProductModule } from '@sharing/product/product.module';\n\nimport { SearchComponent } from './search.component';\n\nconst app: Routes = [ { path: ':slug', component: SearchComponent } ];\n\n@NgModule({\n  declarations: [SearchComponent],\n  imports: [\n    PipesModule,\n    CommonModule,\n    ProductModule,\n    MDBBootstrapModule,\n    OfertasModule,\n    RouterModule.forChild(app)\n  ]\n})\nexport class SearchModule { }\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\n\nimport { StorageMap } from '@ngx-pwa/local-storage';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nimport { SeoService } from '@core/services/seo.service';\nimport { UtilService } from '@core/services/util.service';\nimport { DataService } from '@core/services/data.service';\n\n\n@Component({\n  selector: 'app-search',\n  templateUrl: './search.component.html',\n  styleUrls: ['./search.component.scss']\n})\nexport class SearchComponent implements OnInit {\n\n  slug: Observable<string>;\n  loja: any = [];\n  items: any = [];\n  fill: any = [];\n  product: any = [];\n  message: string = '';\n\n  constructor(\n    private seo: SeoService,\n    private util: UtilService,\n    private db: DataService,\n    private act: ActivatedRoute,\n    private storageMap: StorageMap\n  ) { }\n\n  ngOnInit(): void {\n    this.seo.addCanonical();\n    this.slug = this.act.paramMap.pipe(map(paramsMap => paramsMap.get('slug')));\n    this.slug.subscribe(data => {\n      this.Search(data);\n    }, err => console.log(err));\n  }\n\n  Search(slug: string) {\n    let ofertas: any = [];\n    const fills: any = [];\n    const text = slug.split('-').join('%20');\n    const search = slug.split('-').join(' ');\n    this.storageMap.watch('Loja').subscribe(({ loja }) => {\n      this.db.Search(text).subscribe(\n        res => {\n          // tslint:disable-next-line: forin\n          for (const k in res) {\n            // tslint:disable-next-line: forin\n            for (const i in res[k].ofertas) {\n              if (res[k].ofertas[i].loja === +loja){\n                ofertas = {\n                  campanhaId: res[k].ofertas[i].campanhaId,\n                  campanha: res[k].ofertas[i].campanha,\n                  hostId: res[k].ofertas[i].hostId,\n                  host: res[k].ofertas[i].host,\n                  loja: res[k].ofertas[i].loja,\n                  departamento: res[k].ofertas[i].departamento,\n                  slug: res[k].ofertas[i].slug,\n                  preco_regular: res[k].ofertas[i].preco_regular,\n                  parcela_regular: res[k].ofertas[i].parcela_regular,\n                  qtd_regular: res[k].ofertas[i].qtd_regular,\n                  preco_clube: res[k].ofertas[i].preco_clube,\n                  parcela_clube: res[k].ofertas[i].parcela_clube,\n                  qtd_clube: res[k].ofertas[i].qtd_clube,\n                  dsc_kit: res[k].ofertas[i].dsc_kit,\n                  cod_kit: res[k].ofertas[i].cod_kit,\n                  produtos: res[k]\n                };\n                fills.push(ofertas);\n              }\n            }\n          }\n          this.items = fills;\n          if (this.items.length > 0) {\n            this.message = `Ofertas encontradas para a sua busca \"${search}\".`;\n            this.seo.dataLayerTracking({\n              event: 'siteSearch',\n              searchTerm: search\n            });\n          } else {\n            this.seo.dataLayerTracking({\n              event: 'notfound',\n              searchTerm: search\n            });\n            this.message = 'Esse produto não está disponível no site.<br>Mas aproveite as outras ofertas que preparamos para você.';\n          }\n        },\n        err => {\n          console.log(err);\n        }\n      );\n    });\n  }\n  trackBy = (index: number, item: any) => item[index];\n}\n"]}